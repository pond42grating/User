<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Manpower Table with Export</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #f4f7f6;
      color: #333;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #f4f7f6;
    }
    input[type="text"], input[type="number"] {
      margin: 5px;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      width: 150px;
    }
    button {
      padding: 10px 15px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #45a049;
    }
  </style>
</head>
<body>
  <h1>Manpower Table with Export Functionality</h1>

  <!-- Input Form -->
  <div>
    <input type="text" id="badgeNo" placeholder="Badge No.">
    <input type="text" id="name" placeholder="Name">
    <input type="text" id="trade" placeholder="Trade">
    <input type="number" id="normalHour" placeholder="Normal Hour">
    <input type="number" id="otHour" placeholder="OT Hour">
    <input type="text" id="holiday" placeholder="Holiday">
    <button id="addManpowerBtn">Add Manpower</button>
  </div>

  <!-- Manpower Table -->
  <table id="manpowerTable">
    <tr>
      <th>Badge No.</th>
      <th>Name</th>
      <th>Trade</th>
      <th>Normal Hour</th>
      <th>OT Hour</th>
      <th>Holiday</th>
      <th>Actions</th>
    </tr>
  </table>

  <script>
    const addManpowerBtn = document.getElementById("addManpowerBtn");
    const manpowerTable = document.getElementById("manpowerTable");

    // Add a new row to the table
    addManpowerBtn.addEventListener("click", () => {
      const badgeNo = document.getElementById("badgeNo").value.trim();
      const name = document.getElementById("name").value.trim();
      const trade = document.getElementById("trade").value.trim();
      const normalHour = document.getElementById("normalHour").value.trim();
      const otHour = document.getElementById("otHour").value.trim();
      const holiday = document.getElementById("holiday").value.trim();

      if (!badgeNo || !name || !trade || !normalHour || !otHour || !holiday) {
        alert("Please fill in all fields.");
        return;
      }

      const row = manpowerTable.insertRow();
      row.innerHTML = `
        <td>${badgeNo}</td>
        <td>${name}</td>
        <td>${trade}</td>
        <td>${normalHour}</td>
        <td>${otHour}</td>
        <td>${holiday}</td>
        <td>
          <button class="delete-btn">Delete</button>
          <button class="export-btn">Export</button>
        </td>
      `;

      // Clear input fields
      document.getElementById("badgeNo").value = "";
      document.getElementById("name").value = "";
      document.getElementById("trade").value = "";
      document.getElementById("normalHour").value = "";
      document.getElementById("otHour").value = "";
      document.getElementById("holiday").value = "";
    });

    // Add event listeners for Delete and Export buttons
    manpowerTable.addEventListener("click", (event) => {
      if (event.target.classList.contains("delete-btn")) {
        // Delete the row
        const row = event.target.parentNode.parentNode;
        row.parentNode.removeChild(row);
      } else if (event.target.classList.contains("export-btn")) {
        // Export the row data to CSV
        const row = event.target.parentNode.parentNode;
        const rowData = Array.from(row.cells).slice(0, -1).map((cell) => cell.textContent);
        exportToCSV(rowData);
      }
    });

    // Function to export a single row to CSV
    function exportToCSV(rowData) {
      const headers = ["Badge No.", "Name", "Trade", "Normal Hour", "OT Hour", "Holiday"];
      let csvContent = headers.join(",") + "\n";
      csvContent += rowData.join(",") + "\n";

      // Create a downloadable CSV file
      const blob = new Blob([csvContent], { type: "text/csv" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "Manpower_Export.csv";
      a.click();
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>